/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.7
 */
import{r as e,c as t,h as i,g as s}from"./p-3f4a1f2c.js";const a=class{constructor(i){e(this,i),this.arcgisFlowItemBack=t(this,"arcgisFlowItemBack",7),this.arcgisFlowItemClose=t(this,"arcgisFlowItemClose",7),this.arcgisGetVersions=t(this,"arcgisGetVersions",7),this.arcgisManageVersion=t(this,"arcgisManageVersion",7),this.arcgisNewVersion=t(this,"arcgisNewVersion",7),this._versionListEventListeners=new Map,this._arcgisGetVersions=e=>{this.arcgisGetVersions.emit(e.detail)},this._arcgisManageVersion=e=>{this.arcgisManageVersion.emit(e.detail)},this._arcgisNewVersion=e=>{this.arcgisNewVersion.emit(e.detail)},this.serviceItemElementProps=void 0}disconnectedCallback(){this._versionList&&this._removeVersionListEventListeners(this._versionList)}render(){const{serviceItemElementProps:{allowEditing:e,closable:t,currentUser:s,executionError:a,currentVersionIdentifier:c,flowElement:r,hasAdvEditingUte:n,heading:o,isVersioningApiAvailable:l,pageSize:d,serviceName:h,serviceUrl:b,state:f,strings:m,versionInfos:p}}=this;let{_versionList:g}=this;const v=i("calcite-combobox",{key:"e80f4924dbd00f2a29140b91ee53369dff826d39",clearDisabled:!0,label:h,maxItems:5,overlayPositioning:"fixed",selectionMode:"single-persist",onCalciteComboboxChange:e=>{const t=e.target,i=p.find((e=>e.versionIdentifier.guid===t.value));this.arcgisManageVersion.emit({actionType:"changeVersion",serviceUrl:b,versionInfo:i})}},p?p.map((e=>i("calcite-combobox-item",{selected:c.guid===e.versionIdentifier.guid&&c.name===e.versionIdentifier.name,textLabel:e.versionIdentifier.name,value:e.versionIdentifier.guid}))):void 0);let u,k;return e&&(u=i("calcite-action",{key:"fc6779c583aa81cf1f12584bda094b7d0d25dd06",id:`actionManageVersions_${h}`,icon:"list",scale:"s",slot:"control",text:"",onClick:async()=>{g=document.createElement("arcgis-version-management-version-list"),g.versionListElementProps={closable:t,currentUser:s,currentVersionIdentifier:c,executionError:a,hasAdvEditingUte:n,heading:o,isVersioningApiAvailable:l,pageSize:d,serviceName:h,serviceUrl:b,state:f,strings:m,versionInfos:p},g.addEventListener("calciteFlowItemBack",(e=>{e.preventDefault(),this.arcgisFlowItemBack.emit()})),g.addEventListener("calciteFlowItemClose",(()=>{this.arcgisFlowItemClose.emit()})),this._addVersionListEventListeners(g),r.append(g)}}),k=i("calcite-tooltip",{key:"5d9377d1bec63e4c3d310a3941c0ad693e81f48b",overlayPositioning:"fixed",referenceElement:`actionManageVersions_${h}`},i("span",{key:"ce2e9fc08127e075738fb2cc59fa5387343eda50"},m.headers.manageVersions))),i("calcite-block",{key:"357a2c3e708f61505efa5e1a8f82a7c8ab4ac8dd",open:!0,heading:h},v,u,k)}_addVersionListEventListeners(e){e.addEventListener("arcgisGetVersions",this._arcgisGetVersions),this._versionListEventListeners.set("arcgisGetVersions",this._arcgisGetVersions),e.addEventListener("arcgisManageVersion",this._arcgisManageVersion),this._versionListEventListeners.set("arcgisManageVersion",this._arcgisManageVersion),e.addEventListener("arcgisNewVersion",this._arcgisNewVersion),this._versionListEventListeners.set("arcgisNewVersion",this._arcgisNewVersion)}_removeVersionListEventListeners(e){for(const[t,i]of this._versionListEventListeners)e.removeEventListener(t,i)}get el(){return s(this)}},c=class{constructor(i){e(this,i),this.arcgisAlterVersion=t(this,"arcgisAlterVersion",7),this.arcgisCreateVersion=t(this,"arcgisCreateVersion",7),this.arcgisFlowItemBack=t(this,"arcgisFlowItemBack",7),this.arcgisFlowItemClose=t(this,"arcgisFlowItemClose",7),this._switchToVersion=!0,this._handleCancel=()=>{this.arcgisFlowItemBack.emit()},this._handleChange=e=>{const{_mode:t,_ownerName:i,_versionName:s,versionPropertiesElementProps:{currentUser:a,serviceUrl:c,versionInfo:r}}=this;let{_alterVersionParameters:n,_createVersionParameters:o}=this;switch("create"===t&&(o||(o={access:"public",description:"",featureServerUrl:c,ownerName:a.toUpperCase(),versionName:""})),"edit"===t&&(n||(n={featureServerUrl:c,versionIdentifier:r.versionIdentifier,ownerName:i,versionName:s,access:r.access,description:r.description})),e.type){case"calciteChipGroupSelect":{const i=e.target.label,s=e.target.selectedItems[0].value;"create"===t&&(o={...o,[i]:s}),"edit"===t&&(n={...n,[i]:s});break}case"calciteInputTextInput":{const i=e.target.name,s=e.target.value;"create"===t&&(o={...o,[i]:s}),"edit"===t&&(n={...n,[i]:s});break}case"calciteTextAreaInput":{const i=e.target.name,s=e.target.value;"create"===t&&(o={...o,[i]:s}),"edit"===t&&(n={...n,[i]:s});break}}"create"===t&&("public"!==o.access&&a.toUpperCase()!==o.ownerName?.toUpperCase()?(this.switchToVersionCheckboxElement.checked=!1,this.switchToVersionCheckboxElement.disabled=!0):this.switchToVersionCheckboxElement.disabled=!1,this._createVersionParameters=o),"edit"===t&&(this._alterVersionParameters=n)},this._handleClose=()=>{this.arcgisFlowItemClose.emit()},this._handleSave=()=>{const{_alterVersionParameters:e,_createVersionParameters:t,_mode:i,_switchToVersion:s}=this;"create"===i&&this.arcgisCreateVersion.emit({createVersionParameters:t,switchToVersion:s}),"edit"===i&&this.arcgisAlterVersion.emit({alterVersionParameters:e})},this._handleSwitchToVersionChange=e=>{this._switchToVersion=e.target.checked},this.versionPropertiesElementProps=void 0}async componentWillLoad(){const{versionPropertiesElementProps:{versionInfo:e}}=this;e?(this._mode="edit",this._fullVersionName=e.versionIdentifier.name,this._ownerName=this._fullVersionName.substring(0,this._fullVersionName.lastIndexOf(".")).toUpperCase(),this._versionName=this._fullVersionName.substring(this._fullVersionName.lastIndexOf(".")+1)):this._mode="create"}componentDidRender(){"create"===this._mode&&this.versionNameInputElement?.setFocus()}render(){const{versionPropertiesElementProps:{closable:e,currentUser:t,hasAdvEditingUte:s,state:a,strings:c,versionInfo:r},_mode:n,_ownerName:o,_versionName:l}=this,d=i("div",{key:"135d4141e995bbf31123c16d900a1e274575aafb"},i("calcite-button",{key:"44a78143d595fe108d1d312da6ba1bf340be77b8",appearance:"outline",slot:"footer",width:"half",onClick:this._handleCancel},c.actions.cancelSave),i("calcite-button",{key:"30b32b985a16d7841a444e638309b914cac1b406",slot:"footer",width:"half",onClick:this._handleSave},c.actions.saveVersion)),h=i("calcite-label",{key:"fb496917361a78043ca219cdb438f30414dd5acd"},c.input.versionAccess,i("calcite-chip-group",{key:"f81920bbcdc1bd18187b8107d039cd2a61b8e4dc",label:"access",onCalciteChipGroupSelect:this._handleChange,selectionMode:"single-persist"},i("calcite-chip",{key:"9e55255b9114d1d239a17248ccd200fd097af5f2",selected:"edit"===n&&"public"===r.access||"create"===n,value:"public"},c.accessLevels.public),i("calcite-chip",{key:"03374352be5cfff98f80bb915fe75be762078258",selected:"edit"===n&&"protected"===r.access,value:"protected"},c.accessLevels.protected),i("calcite-chip",{key:"452499aeb04c69b51101b774d91c0479753cf43b",selected:"edit"===n&&"private"===r.access,value:"private"},c.accessLevels.private))),b=i("calcite-label",{key:"11c04b89dfd8d85b68d322d552ece3bf5cc35567"},c.input.versionDescription,i("calcite-text-area",{key:"469568f5e6f902076338f1e7a99332d724ff54da",name:"description",onCalciteTextAreaInput:this._handleChange,resize:"vertical",value:"edit"===n?r.description:""})),f=i("calcite-label",{key:"14b2dabc65093f576b8ebca98cec745210353c0b"},c.input.versionName,i("calcite-input-text",{key:"04c0d47377ea59031fa88c38b996203b0d7c9175",ref:e=>{this.versionNameInputElement=e},name:"versionName",onCalciteInputTextInput:this._handleChange,maxLength:62,value:"edit"===n?l:""})),m=i("calcite-label",{key:"b1773ab9fd4183852b522f465a6ba5347934c358"},c.input.versionOwner,i("calcite-input-text",{key:"e62366ef2e7c143e9f63be1ae177a6b1a3639bce",name:"ownerName",onCalciteInputTextInput:this._handleChange,disabled:!s,value:"edit"===n?o:t.toUpperCase()})),p="create"===n?i("calcite-label",{layout:"inline"},i("calcite-checkbox",{ref:e=>{this.switchToVersionCheckboxElement=e},checked:!0,name:"switchToVersion",onCalciteCheckboxChange:this._handleSwitchToVersionChange}),c.actions.switchToVersion):void 0;return i("calcite-flow-item",{key:"79059091093b6a5c977b43c2530db56f86c98133",closable:e,description:r?r.versionIdentifier.name:"",heading:r?c.actions.editVersion:c.actions.newVersion,onCalciteFlowItemClose:this._handleClose},i("calcite-panel",{key:"0eecfe1d97445089ef205e3c4dc569a23edc863c",loading:"executing"===a},i("calcite-block",{key:"ae61afab2e9d622c41d4b2e0f833057ceba024e0",heading:"",open:!0},f,b,h,m,p,d)))}get el(){return s(this)}};export{a as arcgis_version_management_service_item,c as arcgis_version_management_version_properties}