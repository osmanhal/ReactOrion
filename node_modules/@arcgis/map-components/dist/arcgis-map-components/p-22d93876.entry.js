/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.7
 */
import{r as e,c as i,h as t,g as s}from"./p-3f4a1f2c.js";const n=class{constructor(t){e(this,t),this.arcgisManageVersion=i(this,"arcgisManageVersion",7),this.versionItemElementProps=void 0}render(){const{versionItemElementProps:{currentUser:e,currentVersionIdentifier:i,hasAdvEditingUte:s,isVersioningApiAvailable:n,serviceUrl:r,strings:{actions:a},versionInfo:o}}=this,c=o.versionIdentifier.name,l=c.substring(c.lastIndexOf(".")+1),h=c.substring(0,c.lastIndexOf(".")).toUpperCase(),d=o.versionIdentifier.guid,v=`actionSwitchToVersion_${d}`,g=h.toUpperCase()===e.toUpperCase()&&n&&s,f=i.guid===o.versionIdentifier.guid,p=t("calcite-action",{key:"2f6e3eeea7fc7736a1199a29668894dd80dac94a",disabled:f,id:v,icon:"code-branch",text:"",onClick:()=>{this.arcgisManageVersion.emit({actionType:"changeVersion",serviceUrl:r,versionInfo:o})},slot:"actions-start"}),b=f?void 0:t("calcite-tooltip",{"overlay-positioning":"fixed",referenceElement:v},t("span",null,a.switchToVersion));return t("calcite-list-item",{key:"74b8319a683737aaaf8cfc5f06147eaa401195a6",description:h,label:l,selected:!1,value:d},p,b,t("calcite-action-menu",{key:"535784b416984e07bbfc44a275dfc5c81fb55daf","overlay-positioning":"fixed",slot:"actions-end",label:""},t("calcite-action",{key:"5e89410767d43ab3ce8a6e3ac6ef5d2db5542ea7",disabled:f,icon:"code-branch",onClick:()=>{this.arcgisManageVersion.emit({actionType:"changeVersion",serviceUrl:r,versionInfo:o})},scale:"s",text:a.switchToVersion,textEnabled:!0}),t("calcite-action",{key:"cf3ab694540fb02bcfa7c5ef9557fcb6a93746c1",disabled:!g||f,icon:"code-branch-edit",onClick:()=>{this.arcgisManageVersion.emit({actionType:"editVersion",serviceUrl:r,versionInfo:o})},scale:"s",text:a.editVersion,textEnabled:!0}),t("calcite-action",{key:"bb646b907dbbc62283a15295a265912ba45d73a4",disabled:!g||g&&f,icon:"trash",onClick:()=>{this.arcgisManageVersion.emit({actionType:"deleteVersion",serviceUrl:r,versionInfo:o})},scale:"s",text:a.deleteVersion,textEnabled:!0})))}get el(){return s(this)}},r=class{constructor(t){e(this,t),this.arcgisNewVersion=i(this,"arcgisNewVersion",7),this.arcgisGetVersions=i(this,"arcgisGetVersions",7),this.arcgisManageVersion=i(this,"arcgisManageVersion",7),this._handleFilterChange=()=>{const{versionListElementProps:{versionInfos:e}}=this,i=this._filterInputElement.value.toUpperCase();this._filteredVersionInfos=""===i?e:e.filter((e=>e.versionIdentifier.name.toUpperCase().includes(i)||e.versionIdentifier.guid.toUpperCase().includes(i))),this._filteredVersionInfos.length&&(this.currentPage=1)},this._handleNoticeClosed=()=>{this.versionListElementProps={...this.versionListElementProps,executionError:void 0}},this._handlePaginationChange=e=>{this.currentPage=e.target.startItem},this.currentPage=1,this.versionListElementProps=void 0,this._filteredVersionInfos=void 0}propertiesChangeHandler(e,i){i.versionInfos!==e.versionInfos&&(this._filteredVersionInfos=this.versionListElementProps.versionInfos,this._filterInputElement&&this._handleFilterChange())}componentWillLoad(){this._filteredVersionInfos=this.versionListElementProps.versionInfos}componentDidRender(){this._filterInputElement?.setFocus()}render(){const{currentPage:e,versionListElementProps:{closable:i,currentUser:s,currentVersionIdentifier:n,executionError:r,hasAdvEditingUte:a,heading:o,isVersioningApiAvailable:c,pageSize:l,serviceName:h,serviceUrl:d,state:v,strings:{headers:g},strings:f,versionInfos:p}}=this,b=t("calcite-block",{heading:g.currentVersion,description:n.name,overlayPositioning:"fixed"}),u=t("calcite-action",{id:"actionRefreshVersions",icon:"refresh",text:"",onClick:()=>{this.arcgisGetVersions.emit({serviceUrl:d})},slot:"header-actions-end"},t("calcite-tooltip",{"overlay-positioning":"fixed",referenceElement:"actionRefreshVersions"},t("span",null,f.actions.refreshVersions)));this._paginatedVersionInfos=this._filteredVersionInfos.length>l?this._paginate(this._filteredVersionInfos,l,e):this._filteredVersionInfos;const m=this._filteredVersionInfos.length>l?t("calcite-pagination",{onCalcitePaginationChange:this._handlePaginationChange,pageSize:1,startItem:e,totalItems:Math.ceil(this._filteredVersionInfos.length/l)}):void 0,x=this._paginate(this._paginatedVersionInfos,l,1).map((e=>t("arcgis-version-management-version-item",{versionItemElementProps:{currentUser:s,currentVersionIdentifier:n,isCurrentVersionCard:!1,hasAdvEditingUte:a,isVersioningApiAvailable:c,serviceUrl:d,strings:f,versionInfo:e}}))),E=p.length>l?t("calcite-block",{heading:"",open:!0},t("calcite-input-text",{ref:e=>{this._filterInputElement=e},clearable:!0,icon:"search",onCalciteInputTextInput:this._handleFilterChange,placeholder:f.actions.searchVersions})):void 0,V=t("calcite-list",null,x),I=c&&a?t("calcite-fab",{appearance:"outline-fill",slot:"fab",textEnabled:!0,text:f.actions.newVersion,onClick:()=>{this.arcgisNewVersion.emit({serviceUrl:d})}}):void 0,k=r?t("calcite-notice",{onCalciteNoticeClose:this._handleNoticeClosed,class:"notice",closable:!0,kind:"warning",open:!0,scale:"s",slot:"footer",width:"full"},t("div",{slot:"message"},this._getExecutionError(r))):void 0;return t("calcite-flow-item",{closable:i,description:h,heading:o},t("calcite-panel",{loading:"executing"===v},b,t("calcite-panel",{heading:this._filteredVersionInfos.length?`${f.headers.manageVersions} (${this._filteredVersionInfos.length})`:f.headers.manageVersions},u,E,V,I),m,k))}_getExecutionError(e){const{versionListElementProps:{strings:{executionErrors:i}}}=this;switch(e){case"no-advanced-editing-user-type-extension":return i.noAdvancedEditingUserTypeExtension;case"no-feature-service-found":return i.noFeatureServiceFound;case"no-valid-enterprise-version":return i.notValidEnterpriseVersion;case"no-valid-version-name":return i.invalidVersionName;default:return e}}_paginate(e,i,t){return e.slice((t-1)*i,t*i)}get el(){return s(this)}static get watchers(){return{versionListElementProps:["propertiesChangeHandler"]}}};export{n as arcgis_version_management_version_item,r as arcgis_version_management_version_list}