import{bL as c,v as s,y as i,dh as f,z as v,ba as m,d3 as x,dj as b,h5 as z,bY as $,h6 as E,h7 as _}from"./index-BfC8i6jT.js";import{c as w}from"./Analysis-B2gEupWI.js";import{f as O,u as R}from"./LineOfSightAnalysisTarget-Br7h41rv.js";import{i as j}from"./elevationInfoUtils-Dkzy2V0O.js";const a=c.ofType(O);let t=class extends w{constructor(e){super(e),this.type="line-of-sight",this.observer=null,this.extent=null}initialize(){this.addHandles(m(()=>this._computeExtent(),e=>{(e==null?void 0:e.pending)==null&&this._set("extent",e!=null?e.extent:null)},x))}get targets(){return this._get("targets")||new a}set targets(e){this._set("targets",b(e,this.targets,a))}get spatialReference(){var e;return((e=this.observer)==null?void 0:e.position)!=null?this.observer.position.spatialReference:null}get requiredPropertiesForEditing(){var e;return[(e=this.observer)==null?void 0:e.position]}async waitComputeExtent(){const e=this._computeExtent();return e!=null?e.pending:Promise.resolve()}_computeExtent(){var h;const e=this.spatialReference;if(((h=this.observer)==null?void 0:h.position)==null||e==null)return null;const p=r=>j(r.position,r.elevationInfo)==="absolute-height",n=this.observer.position,u=z(n.x,n.y,n.z,n.x,n.y,n.z);for(const r of this.targets)if(r.position!=null){const o=$(r.position,e);if(o.pending!=null)return{pending:o.pending,extent:null};if(o.geometry!=null){const{x:d,y:g,z:y}=o.geometry;E(u,[d,g,y])}}const l=_(u,e);return p(this.observer)&&this.targets.every(p)||(l.zmin=void 0,l.zmax=void 0),{pending:null,extent:l}}clear(){this.observer=null,this.targets.removeAll()}};s([i({type:["line-of-sight"]})],t.prototype,"type",void 0),s([i({type:R,json:{read:!0,write:!0}})],t.prototype,"observer",void 0),s([i({cast:f,type:a,nonNullable:!0,json:{read:!0,write:!0}})],t.prototype,"targets",null),s([i({value:null,readOnly:!0})],t.prototype,"extent",void 0),s([i({readOnly:!0})],t.prototype,"spatialReference",null),s([i({readOnly:!0})],t.prototype,"requiredPropertiesForEditing",null),t=s([v("esri.analysis.LineOfSightAnalysis")],t);const L=t;export{L as v};
