function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/calcite-button-CtsLJU0N.js","assets/button-Ds3IAz_z.js","assets/index-BfC8i6jT.js","assets/index-CKzvfSE0.css","assets/form-CZfgqAxW.js","assets/dom-Bb9h_pls.js","assets/interactive-DP0XaYPR.js","assets/label-NjdjENzu.js","assets/component-CVleUxfT.js","assets/loadable-QAoPxwWP.js","assets/locale-CiqLNmAk.js","assets/key-DuBxtzvS.js","assets/observers-BDfujgVA.js","assets/t9n-BUWevPjH.js","assets/icon-BWRRlyjd.js","assets/loader-DI4JVeCP.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{v as i,y as n,bw as m,ca as $,z as w,W as C,bL as B,dh as L,ba as p,d3 as V,dj as H,dc as O,di as T,gk as S,gl as I,c7 as N,gm as k,_ as D,bP as r,bR as b}from"./index-BfC8i6jT.js";import{v as f}from"./LineOfSightAnalysis-Dtl18_Ne.js";import{u as x,f as P}from"./LineOfSightAnalysisTarget-Br7h41rv.js";import{u as R,m as z,j as E}from"./elevationInfoUtils-Dkzy2V0O.js";import{_ as G}from"./AnalysisViewModel-CWUiQz4q.js";import"./Analysis-B2gEupWI.js";import"./persistable-D1kMTcLV.js";import"./multiOriginJSONSupportUtils-C0wm8_Yw.js";import"./resourceExtension-btAfE1S2.js";let h=class extends C{constructor(t){super(t),this.location=null,this.intersectedLocation=null,this.intersectedGraphic=null,this.visible=void 0}};i([n({type:m})],h.prototype,"location",void 0),i([n({type:m})],h.prototype,"intersectedLocation",void 0),i([n({type:$})],h.prototype,"intersectedGraphic",void 0),i([n({type:Boolean})],h.prototype,"visible",void 0),h=i([w("esri.widgets.LineOfSight.LineOfSightTarget")],h);const A=h,_=B.ofType(A);let c=class extends G{constructor(e){super(e),this.analysis=null,this.supportedViewType="3d",this.unsupportedErrorMessage="LineOfSightViewModel is only supported in 3D views.",this._vmTargetsToConnection=new Map,this._analysisTargetsToConnection=new Map}initialize(){this.addHandles([this.targets.on("after-add",e=>this._onViewModelTargetAdded(e.item)),this.targets.on("after-remove",e=>this._onViewModelTargetRemoved(e.item)),p(()=>this.analysis,e=>this._onAnalysisChange(e),V)])}destroy(){this._analysisTargetsToConnection.forEach(e=>e.remove())}get state(){return this.disabled||!this.ready?"disabled":this.tool==null?"ready":this.tool.state}get observer(){const{observer:e}=this.analysis;return(e==null?void 0:e.position)==null?null:this._convertAnalysisPointToAbsoluteHeight(e.position,e.elevationInfo)}set observer(e){let t=null;e&&(t=e.clone(),t.hasZ||(t.z=0)),this.analysis.observer=new x({position:t})}get targets(){return this._get("targets")||new _}set targets(e){this._set("targets",H(e,this.targets,_))}continue(){this.tool!=null&&this.tool.continue()}stop(){this.tool!=null&&this.tool.stop()}get testInfo(){}constructAnalysis(){return new f}async onConnectToAnalysisView(e){this.addHandles([e.on("result-changed",t=>{const s=this._analysisTargetsToConnection.get(t.target);s&&(t.result!=null?(s.viewModelTarget.intersectedGraphic=t.result.intersectedGraphic,s.viewModelTarget.intersectedLocation=t.result.intersectedLocation,s.viewModelTarget.visible=t.result.visible):(s.viewModelTarget.intersectedGraphic=null,s.viewModelTarget.intersectedLocation=null,s.viewModelTarget.visible=void 0))})],"view")}onDisconnectFromAnalysisView(){this.removeHandles("view")}_onViewModelTargetAdded(e){if(this._vmTargetsToConnection.get(e))return;const t=new P({position:e.location});this._connectViewModelWithAnalysisTarget(e,t),this.analysis.targets.add(t)}_onViewModelTargetRemoved(e){const t=this._vmTargetsToConnection.get(e);t&&(t.remove(),this.analysis.targets.remove(t.analysisTarget))}_onAnalysisTargetAdded(e){if(this._analysisTargetsToConnection.get(e))return;const{position:t}=e,s=new A({location:t?this._convertAnalysisPointToAbsoluteHeight(t,e.elevationInfo):null});this._connectViewModelWithAnalysisTarget(s,e),this.targets.add(s)}_onAnalysisTargetRemoved(e){const t=this._analysisTargetsToConnection.get(e);t&&(t.remove(),this.targets.remove(t.viewModelTarget))}_connectViewModelWithAnalysisTarget(e,t){let s=!1;const g=O([p(()=>({position:t.position,elevationInfo:t.elevationInfo}),({position:l,elevationInfo:u})=>{s||(s=!0,e.location=l?this._convertAnalysisPointToAbsoluteHeight(l,u):null,s=!1)},T),p(()=>e.location,l=>{if(!s){s=!0;let u=null;l&&(u=l.clone(),u.hasZ||(u.z=0)),t.position=u,t.elevationInfo=null,s=!1}},T)]),v={analysisTarget:t,viewModelTarget:e,remove:()=>{g.remove(),this._vmTargetsToConnection.delete(e),this._analysisTargetsToConnection.delete(t)}};this._vmTargetsToConnection.set(e,v),this._analysisTargetsToConnection.set(t,v)}_onAnalysisChange(e){const t="analysis";this.removeHandles(t),this.addHandles([this.analysis.targets.on("after-add",s=>this._onAnalysisTargetAdded(s.item)),this.analysis.targets.on("after-remove",s=>this._onAnalysisTargetRemoved(s.item))],t),this.targets.removeAll(),e.targets.forEach(s=>{this._onAnalysisTargetAdded(s)})}_convertAnalysisPointToAbsoluteHeight(e,t){const s=e.clone();if(this.view!=null){const g=R(e.hasZ,t);s.z=z(this.view,e,g,E)}return s}};i([n({type:f})],c.prototype,"analysis",void 0),i([n({readOnly:!0})],c.prototype,"state",null),i([n()],c.prototype,"observer",null),i([n({type:_,cast:L,nonNullable:!0})],c.prototype,"targets",null),c=i([w("esri.widgets.LineOfSight.LineOfSightViewModel")],c);const M=c,a="esri-line-of-sight",d={base:a,actions:`${a}__actions`,container:`${a}__container`,error:`${a}__error`,hint:`${a}__hint`,hintText:`${a}__hint-text`,newAnalysisButton:`${a}__new-analysis-button`},y={newAnalysisButton:`${a}__new-button`,continueButton:`${a}__continue-button`,doneButton:`${a}__done-button`};let o=class extends I{constructor(e,t){super(e,t),this.messages=null,this.viewModel=new M,this._onNewAnalysis=()=>{N(this.viewModel.start())},this._onDone=()=>{this.viewModel.stop()},this._onContinue=()=>{this.viewModel.continue()}}loadDependencies(){return k({button:()=>D(()=>import("./calcite-button-CtsLJU0N.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]))})}get active(){return this.viewModel.active}get analysis(){return this.viewModel.analysis}set analysis(e){this.viewModel.analysis=e}get icon(){return"line-of-sight"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}render(){return r("div",{class:this.classes(d.base,b.widget,b.panel),role:"presentation"},this._renderContainerNode())}_renderContainerNode(){if(!this.visible)return null;if(!this.viewModel.supported)return this._renderUnsupportedMessage();let e=null;const t=[this._renderNewAnalysisButton()];return this.viewModel.state==="creating"?(e=this._renderHint(),t.unshift(this._renderDoneButton())):this.viewModel.state==="created"&&this.viewModel.targets.length>0&&t.unshift(this._renderContinueButton()),r("div",{class:d.container},e,r("div",{class:d.actions},t))}_renderUnsupportedMessage(){return r("div",{class:d.error,key:"esri-line-of-sight__unsupported"},r("p",null,this.messages.unsupported))}_renderHint(){return r("div",{class:d.hint,key:"esri-line-of-sight__hint"},r("p",{class:d.hintText},this.messages.hint))}_renderNewAnalysisButton(){return this._renderButton({className:d.newAnalysisButton,id:y.newAnalysisButton,label:this.messages.newAnalysis,onClick:this._onNewAnalysis,primary:!0})}_renderDoneButton(){return this._renderButton({id:y.doneButton,label:this.messages.done,onClick:this._onDone,primary:!1})}_renderContinueButton(){return this._renderButton({id:y.newAnalysisButton,label:this.messages.continueAnalysis,onClick:this._onContinue,primary:!1})}_renderButton({className:e,id:t,label:s,onClick:g,primary:v}){const l=this.viewModel.state==="disabled";return r("calcite-button",{appearance:v?"solid":"outline-fill",class:e,"data-id":t,disabled:l,key:t,onclick:g},s)}get test(){}};i([n()],o.prototype,"active",null),i([n({constructOnly:!0,nonNullable:!0})],o.prototype,"analysis",null),i([n()],o.prototype,"icon",null),i([n()],o.prototype,"label",null),i([n(),S("esri/widgets/LineOfSight/t9n/LineOfSight")],o.prototype,"messages",void 0),i([n()],o.prototype,"view",null),i([n({type:M})],o.prototype,"viewModel",void 0),i([n()],o.prototype,"visible",null),o=i([w("esri.widgets.LineOfSight")],o);const Y=o;export{Y as default};
