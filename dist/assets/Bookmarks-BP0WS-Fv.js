function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/calcite-action-nUAFESCb.js","assets/action-W5AlSpJC.js","assets/index-BfC8i6jT.js","assets/index-CKzvfSE0.css","assets/dom-Bb9h_pls.js","assets/interactive-DP0XaYPR.js","assets/loadable-QAoPxwWP.js","assets/locale-CiqLNmAk.js","assets/key-DuBxtzvS.js","assets/observers-BDfujgVA.js","assets/component-CVleUxfT.js","assets/t9n-BUWevPjH.js","assets/icon-BWRRlyjd.js","assets/loader-DI4JVeCP.js","assets/calcite-button-CtsLJU0N.js","assets/button-Ds3IAz_z.js","assets/form-CZfgqAxW.js","assets/label-NjdjENzu.js","assets/calcite-chip-group-CuMIy2-A.js","assets/calcite-chip-D9LtCofM.js","assets/chip-D5D8cU_q.js","assets/calcite-fab-CNUKuMzr.js","assets/calcite-flow-BgHZuPip.js","assets/calcite-flow-item-DILoX5zh.js","assets/panel-BweYboDk.js","assets/action-menu-BPjrKXqF.js","assets/array-l3358aeC.js","assets/popover-DmSCpKUv.js","assets/floating-ui-Bi24_oLL.js","assets/debounce-BE9q2DI6.js","assets/focusTrapComponent-CMnNxtIs.js","assets/openCloseComponent-C9eX_zZX.js","assets/Heading-DAjBEeC2.js","assets/FloatingArrow-DSHVPzyR.js","assets/scrim-CG0P7lnL.js","assets/calcite-icon-Cu5Qwr0G.js","assets/calcite-input-DZ6coDfJ.js","assets/input2-D7j5EHhc.js","assets/Validation-B3Y-COKw.js","assets/input-CM-Sufcv.js","assets/input-message-sNs3yQQx.js","assets/progress-BnUvB3t-.js","assets/calcite-input-message-CQK3LrUP.js","assets/calcite-label-D36Vj_AH.js","assets/calcite-list-D-WpqrBC.js","assets/resources4-VzuD1qlP.js","assets/utils3-B08RV_oB.js","assets/filter-Bhg806Ig.js","assets/calcite-list-item-Cpm4rMAS.js","assets/handle-nlmkhwGe.js","assets/calcite-loader-iu2j0bUh.js","assets/calcite-notice-CD1j-oCN.js","assets/conditionalSlot-bqgZ4YTq.js","assets/calcite-scrim-DuiYffm1.js","assets/calcite-switch-CRaUWSAZ.js","assets/switch-Cqu50_Cn.js","assets/calcite-table-DZzX2GJu.js","assets/calcite-table-cell-Ce4s0f7r.js","assets/table-cell-rtcFzOu8.js","assets/calcite-table-header-DULqJa16.js","assets/table-header-CEk4RZ68.js","assets/calcite-table-row-7gdF9KiP.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{v as n,y as l,z as D,W as Z,bL as K,h2 as Q,P as X,A as f,gf as Y,gd as tt,k7 as A,J as x,c6 as et,gl as ot,gm as it,_ as c,bP as r,bR as T,aZ as at,ag as M,ah as P,mc as V,gk as q}from"./index-BfC8i6jT.js";import{u as C,t as rt}from"./timeProperties-BLP-Lo-9.js";import{f as G}from"./Bookmark-CSv7LdfP.js";import{e as nt}from"./Heading-DgRsy-7b.js";import{e as lt}from"./vmEvent-D4Ubqkbq.js";let g=class extends Z{constructor(e){super(e)}get editedBookmark(){const{bookmark:e}=this;return e?this._get("editedBookmark")||e.clone():null}get customUrl(){var e,o,i,a;return(o=(e=this.editedBookmark)==null?void 0:e.thumbnail)!=null&&o.isSecureUrl?(a=(i=this.editedBookmark)==null?void 0:i.thumbnail)==null?void 0:a.url:null}set customUrl(e){this._override("customUrl",e)}get screenshotUrl(){var e,o,i,a;return(o=(e=this.editedBookmark)==null?void 0:e.thumbnail)!=null&&o.isDataURI?(a=(i=this.editedBookmark)==null?void 0:i.thumbnail)==null?void 0:a.url:null}set screenshotUrl(e){this._override("screenshotUrl",e)}get state(){return this._get("state")}set state(e){this.validationState=void 0,this.loading=void 0,this._set("state",e)}get thumbnailState(){var e,o,i,a;return(o=(e=this.editedBookmark)==null?void 0:e.thumbnail)!=null&&o.url?(a=(i=this.editedBookmark)==null?void 0:i.thumbnail)!=null&&a.isSecureUrl?"url":"screenshot":"none"}set thumbnailState(e){this._overrideIfSome("thumbnailState",e)}};n([l()],g.prototype,"bookmark",void 0),n([l({readOnly:!0})],g.prototype,"editedBookmark",null),n([l()],g.prototype,"customUrl",null),n([l()],g.prototype,"screenshotUrl",null),n([l()],g.prototype,"state",null),n([l()],g.prototype,"thumbnailState",null),n([l()],g.prototype,"validationState",void 0),n([l()],g.prototype,"loading",void 0),g=n([D("esri.widgets.Bookmarks.BookmarksUserState")],g);const U=g,z=K.ofType(G),st={width:128,height:128,format:"png"},S={takeScreenshot:!0,captureViewpoint:!0,captureRotation:!0,captureScale:!0,captureTimeExtent:!0},H={time:!0};let v=class extends Q(X.EventedAccessor){constructor(t){super(t),this.capabilities={...H},this.activeBookmark=null,this.view=null}destroy(){this.view=null,this._set("activeBookmark",null)}castCapabilities(t){return{...H,...t}}get bookmarks(){var t,e;return((e=(t=this.view)==null?void 0:t.map)==null?void 0:e.bookmarks)??new z}set bookmarks(t){this._overrideIfSome("bookmarks",t)}set defaultCreateOptions(t){this._set("defaultCreateOptions",{...S,...t})}get defaultCreateOptions(){return S}set defaultEditOptions(t){this._set("defaultEditOptions",{...S,...t})}get defaultEditOptions(){return S}get state(){const{view:t}=this;return t&&!t.ready?"loading":"ready"}async createBookmark(t){const{view:e,defaultCreateOptions:o,capabilities:i}=this;if(!e)throw new f("create-bookmark:invalid-view","Cannot create a bookmark without a view.");const{takeScreenshot:a,screenshotSettings:s,captureViewpoint:d,captureRotation:u,captureScale:p,captureTimeExtent:B}={...o,...t},h=a?await this._createThumbnail(s):void 0,E=i.time&&B&&e.timeExtent!=null?e.timeExtent.clone():void 0;return new G({...h&&{thumbnail:h},...B&&{timeExtent:E},...d&&{viewpoint:this._createViewpoint({view:e,captureScale:p,captureRotation:u})}})}async editBookmark(t,e){if(!t)return t;const{view:o,defaultEditOptions:i}=this;if(!o)throw new f("edit-bookmark:invalid-view","Cannot edit a bookmark without a view.");const{takeScreenshot:a,screenshotSettings:s,captureViewpoint:d,captureRotation:u,captureScale:p,captureTimeExtent:B}={...i,...e},h=a?await this._createThumbnail(s):void 0;return h&&(t.thumbnail=h),d&&(t.viewpoint=this._createViewpoint({view:o,captureScale:p,captureRotation:u})),B&&o.timeExtent!=null&&(t.timeExtent=o.timeExtent.clone()),this.emit("bookmark-edit",{bookmark:t}),t}goTo(t){const{capabilities:e,view:o}=this;if(!o)throw new f("go-to:invalid-view","Cannot go to a bookmark without a view");const i=t==null?void 0:t.viewpoint;if(!i)throw new f("go-to:invalid-bookmark","Cannot go to a bookmark that does not contain a 'viewpoint'.",{bookmark:t});this._set("activeBookmark",t);const a={target:i},s=this.callGoTo(a),d=t==null?void 0:t.timeExtent;return e.time&&d&&(o.timeExtent=d),this.emit("bookmark-select",{bookmark:t}),s.catch(()=>{}).then(()=>this._set("activeBookmark",null)),s}async _createThumbnail(t){const{view:e}=this;if(!e)throw new f("bookmark:invalid-view","Cannot create slide thumbnail without a view");const o=await e.takeScreenshot({...st,...t});return new C({url:o.dataUrl})}_createViewpoint({view:t,captureRotation:e,captureScale:o}){var a,s;const i=(a=t.viewpoint)==null?void 0:a.clone();return new Y({targetGeometry:(s=t.extent)==null?void 0:s.clone(),rotation:(e?i==null?void 0:i.rotation:null)??0,scale:(o?i==null?void 0:i.scale:null)??0})}};n([l()],v.prototype,"capabilities",void 0),n([tt("capabilities")],v.prototype,"castCapabilities",null),n([l({readOnly:!0})],v.prototype,"activeBookmark",void 0),n([l({type:z})],v.prototype,"bookmarks",null),n([l()],v.prototype,"defaultCreateOptions",null),n([l()],v.prototype,"defaultEditOptions",null),n([l({readOnly:!0})],v.prototype,"state",null),n([l()],v.prototype,"view",void 0),v=n([D("esri.widgets.Bookmarks.BookmarksViewModel")],v);const j=v;let b=class extends Z{constructor(){super(...arguments),this.addBookmarkButton=!1,this.closeButton=!1,this.collapseButton=!1,this.editBookmarkButton=!1,this.filter=!1,this.flow=!0,this.heading=!1,this.thumbnail=!0,this.time=!0}get addBookmark(){return A(x.getLogger(this),"addBookmark",{replacement:"addBookmarkButton",version:"4.29",warnOnce:!0}),this.addBookmarkButton}set addBookmark(e){A(x.getLogger(this),"addBookmark",{replacement:"addBookmarkButton",version:"4.29",warnOnce:!0}),this.addBookmarkButton=e}};n([l({type:Boolean,nonNullable:!0})],b.prototype,"addBookmark",null),n([l({type:Boolean,nonNullable:!0})],b.prototype,"addBookmarkButton",void 0),n([l({type:Boolean,nonNullable:!0})],b.prototype,"closeButton",void 0),n([l({type:Boolean,nonNullable:!0})],b.prototype,"collapseButton",void 0),n([l({type:Boolean,nonNullable:!0})],b.prototype,"editBookmarkButton",void 0),n([l({type:Boolean,nonNullable:!0})],b.prototype,"filter",void 0),n([l({type:Boolean,nonNullable:!0})],b.prototype,"flow",void 0),n([l({type:Boolean,nonNullable:!0})],b.prototype,"heading",void 0),n([l({type:Boolean,nonNullable:!0})],b.prototype,"thumbnail",void 0),n([l({type:Boolean,nonNullable:!0})],b.prototype,"time",void 0),b=n([D("esri.widgets.Bookmarks.BookmarksVisibleElements")],b);const F=b,_="esri-bookmarks",$=`${_}__authoring`,L=`${_}__bookmark`,k={base:_,noBookmarksHeader:`${_}__no-bookmarks-heading`,noBookmarksDescription:`${_}__no-bookmarks-description`,form:`${_}__form`,list:`${_}__list`,loader:`${_}__loader`,filterNoResults:`${_}__filter-no-results`,formContent:`${_}__form-content`,addBookmarkButton:`${_}__add-bookmark-button`,editBookmarkInput:`${_}__edit-bookmark-input`,addBookmarkInput:`${_}__add-bookmark-input`,dragEnabled:`${_}--drag-enabled`,bookmarkImage:`${_}__image`,bookmarkImageContainer:`${L}-image-container`,bookmarkContent:`${L}-content`,bookmarkContentLabel:`${L}-content-label`,authoring:$,authoringImageContainer:`${$}-image-container`,authoringRefreshThumbnailButton:`${$}-refresh-thumbnail-button`};let m=class extends et(ot){constructor(t,e){super(t,e),this._addInputNode=null,this._editInputNode=null,this._urlEditInputNode=null,this._lastDragDetail=null,this._selectedDragBookmarkUid=null,this._editIncludeTimeExtent=void 0,this._userState=null,this._focusRootFlowItem=!1,this._focusAddFlowItem=!1,this._focusEditFlowItem=!1,this.disabled=!1,this.dragEnabled=!1,this.filterPlaceholder="",this.filterText="",this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.viewModel=new j,this.visibleElements=new F,this._onCalciteListOrderChange=o=>{const{_lastDragDetail:i,bookmarks:a}=this,{toEl:s,fromEl:d,dragEl:u,newIndex:p}=o;if(!a.length||!d||!s||(i==null?void 0:i.newIndex)===p&&(i==null?void 0:i.dragEl)===u&&(i==null?void 0:i.toEl)===s&&(i==null?void 0:i.fromEl)===d)return;this._lastDragDetail=o;const B=Array.from(d.children).filter(h=>h==null?void 0:h.matches("calcite-list-item")).map(h=>h.value);a.sort((h,E)=>{const I=B.indexOf(h.uid),y=B.indexOf(E.uid);return I>y?1:I<y?-1:0})}}normalizeCtorArgs(t){return(t==null?void 0:t.editingEnabled)!=null&&t.visibleElements!=null?{...t,visibleElements:new F({...t.visibleElements,addBookmarkButton:t.editingEnabled,editBookmarkButton:t.editingEnabled})}:t}loadDependencies(){return it({action:()=>c(()=>import("./calcite-action-nUAFESCb.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13])),button:()=>c(()=>import("./calcite-button-CtsLJU0N.js"),__vite__mapDeps([14,15,2,3,16,4,5,17,10,6,7,8,9,11,12,13])),"chip-group":()=>c(()=>import("./calcite-chip-group-CuMIy2-A.js"),__vite__mapDeps([18,2,3,4,5,6])),chip:()=>c(()=>import("./calcite-chip-D9LtCofM.js"),__vite__mapDeps([19,20,2,3,4,6,11,7,8,9,5,10,12])),fab:()=>c(()=>import("./calcite-fab-CNUKuMzr.js"),__vite__mapDeps([21,2,3,4,5,6,15,16,17,10,7,8,9,11,12,13])),flow:()=>c(()=>import("./calcite-flow-BgHZuPip.js"),__vite__mapDeps([22,2,3,9,6])),"flow-item":()=>c(()=>import("./calcite-flow-item-DILoX5zh.js"),__vite__mapDeps([23,2,3,4,5,6,7,8,9,11,24,25,26,1,10,12,13,27,28,29,30,31,32,33,34])),icon:()=>c(()=>import("./calcite-icon-Cu5Qwr0G.js"),__vite__mapDeps([35,12,2,3,4,9])),input:()=>c(()=>import("./calcite-input-DZ6coDfJ.js"),__vite__mapDeps([36,37,2,3,4,16,5,8,17,10,6,7,9,11,38,39,12,40,41])),"input-message":()=>c(()=>import("./calcite-input-message-CQK3LrUP.js"),__vite__mapDeps([42,40,2,3,4,12,9])),label:()=>c(()=>import("./calcite-label-D36Vj_AH.js"),__vite__mapDeps([43,2,3,17,4,10])),list:()=>c(()=>import("./calcite-list-D-WpqrBC.js"),__vite__mapDeps([44,2,3,4,5,9,45,46,6,11,7,8,47,29,12,37,16,17,10,38,39,40,41,13,34])),"list-item":()=>c(()=>import("./calcite-list-item-Cpm4rMAS.js"),__vite__mapDeps([48,2,3,4,5,7,8,9,11,6,46,45,1,10,12,13,49])),loader:()=>c(()=>import("./calcite-loader-iu2j0bUh.js"),__vite__mapDeps([50,13,2,3,4,7,8,9])),notice:()=>c(()=>import("./calcite-notice-CD1j-oCN.js"),__vite__mapDeps([51,2,3,52,9,4,6,7,8,11,31,10,12])),scrim:()=>c(()=>import("./calcite-scrim-DuiYffm1.js"),__vite__mapDeps([53,34,2,3,7,4,8,9,11,13])),switch:()=>c(()=>import("./calcite-switch-CRaUWSAZ.js"),__vite__mapDeps([54,55,2,3,4,16,5,8,17,10,6])),table:()=>c(()=>import("./calcite-table-DZzX2GJu.js"),__vite__mapDeps([56,2,3,6,11,7,4,8,9,15,16,5,17,10,12,13,20])),"table-cell":()=>c(()=>import("./calcite-table-cell-Ce4s0f7r.js"),__vite__mapDeps([57,58,2,3,6,11,7,4,8,9,5])),"table-header":()=>c(()=>import("./calcite-table-header-DULqJa16.js"),__vite__mapDeps([59,60,2,3,6,11,7,4,8,9,10,12])),"table-row":()=>c(()=>import("./calcite-table-row-7gdF9KiP.js"),__vite__mapDeps([61,2,3,4,8,5,10,12,9,58,6,11,7,60]))})}get defaultCreateOptions(){return this.viewModel.defaultCreateOptions}set defaultCreateOptions(t){this.viewModel.defaultCreateOptions=t}get defaultEditOptions(){return this.viewModel.defaultEditOptions}set defaultEditOptions(t){this.viewModel.defaultEditOptions=t}get bookmarks(){return this.viewModel.bookmarks}set bookmarks(t){this.viewModel.bookmarks=t}get editingEnabled(){return A(x.getLogger(this),"editingEnabled",{replacement:"dragEnabled, visibleElements.editBookmarkButton, visibleElements.addBookmarkButton",version:"4.29",warnOnce:!0}),this.dragEnabled&&this.visibleElements.editBookmarkButton&&this.visibleElements.addBookmarkButton}set editingEnabled(t){A(x.getLogger(this),"editingEnabled",{replacement:"dragEnabled, visibleElements.editBookmarkButton, visibleElements.addBookmarkButton",version:"4.29",warnOnce:!0}),this.dragEnabled=t,this.visibleElements.editBookmarkButton=t,this.visibleElements.addBookmarkButton=t}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(t){this.viewModel.goToOverride=t}get icon(){return"bookmark"}set icon(t){this._overrideIfSome("icon",t)}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}endAddBookmark(){this._userState=null}goTo(t){return this.viewModel.goTo(t)}render(){return r("div",{class:this.classes(k.base,T.widget,T.panel)},this._renderBookmarksContainer())}startAddBookmark(){this._userState=new U({state:"add"}),this._focusAddFlowItem=!0}_renderNoBookmarksContainer(t){const{messages:e,viewModel:{state:o}}=this;return t.length||o==="loading"?null:r("div",{class:T.empty,key:"no-bookmarks"},r("calcite-icon",{icon:"bookmark",scale:"l"}),r(nt,{class:this.classes(T.heading,k.noBookmarksHeader),level:this.headingLevel},e==null?void 0:e.noBookmarksHeading),r("p",{class:k.noBookmarksDescription},e.noBookmarksDescription))}_renderEditBookmarkFlowItems(){const{_userState:t}=this,e=t==null?void 0:t.editedBookmark;return e&&(t==null?void 0:t.state)==="edit"?this._renderEditingBookmark(e):[]}_renderBookmarkItems(t){return t?t.toArray().map(e=>this._renderBookmark(e)):[]}_handleCalciteListDragEnd(t){const{fromEl:e,dragEl:o,oldIndex:i}=t;e.insertBefore(o,e.children[i])}_renderBookmarksContainer(){const{viewModel:{state:t,bookmarks:e},dragEnabled:o,messages:i,disabled:a,filterPlaceholder:s,filterText:d,visible:u,headingLevel:p,visibleElements:{closeButton:B,collapseButton:h,filter:E,heading:I,flow:y},uid:J}=this,O=e.filter(at),W=O.length?r("calcite-list",{class:k.list,dragEnabled:o,filterEnabled:E,filterPlaceholder:s,filterText:d,group:`bookmarks-${J}`,key:"bookmark-list",label:i.widgetLabel,selectionAppearance:"border",selectionMode:"none",onCalciteListDragEnd:w=>this._handleCalciteListDragEnd(w.detail),onCalciteListFilter:w=>{var N;return this.filterText=((N=w.target)==null?void 0:N.filterText)??""},onCalciteListOrderChange:w=>this._onCalciteListOrderChange(w.detail)},this._renderBookmarkItems(O),E?r("div",{class:k.filterNoResults,slot:"filter-no-results"},r("calcite-notice",{kind:"info",open:!0,width:"full"},r("div",{slot:"message"},i.noBookmarksHeading),";")):null):null,R=[r("calcite-flow-item",{afterCreate:this._focusRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,closable:B,closed:!u,collapsible:h,disabled:a,heading:I?i.widgetLabel:void 0,headingLevel:p,loading:t==="loading",onCalciteFlowItemClose:()=>this.visible=!1},this._renderNoBookmarksContainer(O),W,this._renderAddBookmarkButton()),this._renderAddingBookmark(),this._renderEditBookmarkFlowItems()];return u?y?r("calcite-flow",{key:"root-flow"},R):R:null}_renderAddBookmarkButton(){const{messages:t,_userState:e,disabled:o,viewModel:{view:i,state:a},visibleElements:{addBookmarkButton:s}}=this,d=(e==null?void 0:e.loading)??!1;return i&&a!=="loading"&&s?r("calcite-fab",{appearance:"outline-fill",bind:this,class:k.addBookmarkButton,disabled:o||d,icon:"plus",key:"add-bookmark-item",kind:"neutral",loading:d,onclick:this.startAddBookmark,slot:"fab",text:t.addBookmark,textEnabled:!0,title:t.addBookmark,type:"button"}):null}_renderEditContainer(t){const{messagesCommon:e,visibleElements:{editBookmarkButton:o}}=this,i=`${e.edit} ${this._getBookmarkTitle(t)}`;return o?r("calcite-action",{appearance:"transparent",icon:"pencil",key:"edit-action",onclick:()=>this._showEditBookmarkForm(t),slot:"actions-end",text:i,title:i}):null}_renderBookmarkImage(t,e){var o;return e?r("img",{alt:"",class:k.bookmarkImage,key:"bookmark-image",src:(o=t.thumbnail)==null?void 0:o.url}):null}_renderBookmarkTimeSwitch(t){const{messages:e,viewModel:{view:o}}=this,{timeExtent:i}=t;return(o==null?void 0:o.timeExtent)??i?r("calcite-label",{layout:"inline-space-between"},e.includeTimeExtent,r("calcite-switch",{checked:!!i,onCalciteSwitchChange:a=>{this._editIncludeTimeExtent=!!a.target.checked}})):null}_renderEditBookmarkTimeExtent(t){return this._editIncludeTimeExtent?this._renderBookmarkTimeExtent(t):null}_getTimeExtentStrings(t){const{visibleElements:e}=this,{timeExtent:o}=t;if(!o)return{};const{start:i,end:a}=o,s=a!=null&&(i==null||i.getTime()!==a.getTime()),d=i?this._formatDate(i):"",u=i&&e.time?this._formatTime(i):"";return s?{startDate:d,startTime:u,endDate:this._formatDate(a),endTime:e.time?this._formatTime(a):""}:{startDate:d,startTime:u}}_renderTimeExtentDescription(t){const{startDate:e,startTime:o,endDate:i,endTime:a}=this._getTimeExtentStrings(t);if(!e)return"";const s=`${e} ${o}`;return i?`${s} - ${`${i} ${a}`}`:s}_renderBookmarkTimeExtent(t,e=!1){const{messages:o}=this,{startDate:i,startTime:a,endDate:s,endTime:d}=this._getTimeExtentStrings(t),u=e?null:r("calcite-table-row",{slot:"table-header"},r("calcite-table-header",{heading:o.startDate}),s?r("calcite-table-header",{heading:o.endDate}):null);return i?r("calcite-table",{caption:o.timeExtent,scale:"s"},u,r("calcite-table-row",null,r("calcite-table-cell",null,i," ",a?[r("br",null),a]:null),s?r("calcite-table-cell",null,s,d?[r("br",null),d]:null):null)):null}_renderBookmarkActiveScrim(t,e){return this.viewModel.activeBookmark===t&&e?r("calcite-scrim",{key:"bookmark-active-scrim",loading:!0}):null}_renderBookmarkActiveLoader(t,e){return this.viewModel.activeBookmark!==t||e?null:r("calcite-loader",{class:k.loader,inline:!0,key:"bookmark-active-loader",label:this.messagesCommon.loading})}_renderBookmarkImageIcon(t,e){return this.viewModel.activeBookmark===t||e?null:r("calcite-icon",{icon:"bookmark",key:"bookmark-icon",scale:"s"})}_renderBookmarkThumbnail(t){var o;const e=this.visibleElements.thumbnail&&!!((o=t.thumbnail)!=null&&o.url);return r("div",{class:k.bookmarkImageContainer,slot:"content-start"},this._renderBookmarkActiveScrim(t,e),this._renderBookmarkImage(t,e),this._renderBookmarkActiveLoader(t,e),this._renderBookmarkImageIcon(t,e))}_focusSelectedDragEl(t,e){this._selectedDragBookmarkUid===e.uid&&requestAnimationFrame(()=>t==null?void 0:t.setFocus())}_handleCalciteListItemDragHandleChange(t,e){t.stopPropagation();const o=t.target.dragSelected;this._selectedDragBookmarkUid=o?e.uid:null}_renderBookmark(t){return r("calcite-list-item",{afterCreate:e=>this._focusSelectedDragEl(e,t),afterUpdate:e=>this._focusSelectedDragEl(e,t),class:this.classes({[k.dragEnabled]:this.dragEnabled}),description:this._renderTimeExtentDescription(t),dragSelected:t.uid===this._selectedDragBookmarkUid,key:t.uid,label:this._getBookmarkTitle(t),value:t.uid,onCalciteListItemDragHandleChange:e=>this._handleCalciteListItemDragHandleChange(e,t),onCalciteListItemSelect:()=>this._goToBookmark(t)},this._renderBookmarkThumbnail(t),this._renderBookmarkContent(t),this._renderEditContainer(t))}_renderBookmarkContent(t){return r("div",{class:k.bookmarkContent,slot:"content"},r("span",{class:k.bookmarkContentLabel},this._getBookmarkTitle(t)),this._renderBookmarkTimeExtent(t,!0))}_renderEditingBookmarkName(t){const{messages:e,_userState:o}=this,i=(o==null?void 0:o.validationState)==="name-required";return r("calcite-label",null,e.title,r("calcite-input",{afterCreate:this._storeEditInput,bind:this,class:k.editBookmarkInput,name:"bookmark-name",placeholder:e.titlePlaceholder,required:!0,type:"text",value:t.name}),i?r("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},e.invalidTitle):null)}_renderEditingBookmarkActions(){const{messagesCommon:t,_userState:e}=this,o=e==null?void 0:e.bookmark;return[r("calcite-button",{appearance:"transparent",kind:"danger",onclick:()=>this._deleteBookmark(o),slot:"footer",type:"button",width:"full"},t.delete),r("calcite-button",{appearance:"outline",bind:this,onclick:this._closeEditBookmarkForm,slot:"footer",type:"button",width:"full"},t.cancel),r("calcite-button",{slot:"footer",type:"submit",width:"full"},t.save)]}_handleUrlEditInputChange(){var a,s;const{_userState:t,_urlEditInputNode:e}=this,o=e==null?void 0:e.value;if(!(t!=null&&t.editedBookmark)||!o)return;t.validationState=void 0,(a=t.editedBookmark.thumbnail)!=null&&a.isDataURI&&(t.screenshotUrl=(s=t.editedBookmark.thumbnail)==null?void 0:s.url);const i=new C({url:o});i.isSecureUrl&&(t.customUrl=o,t.editedBookmark.thumbnail=i)}_renderEditingTimeExtent(t){const{capabilities:e,view:o}=this.viewModel,{timeExtent:i}=t;return e.time&&((o==null?void 0:o.timeExtent)??i)?r("div",{key:"edit-bookmark-time-container"},this._renderBookmarkTimeSwitch(t),this._renderEditBookmarkTimeExtent(t)):null}_renderEditingBookmarkImage(t){var a,s;const{_userState:e}=this,o=e==null?void 0:e.thumbnailState,i=(a=t.thumbnail)!=null&&a.isSecureUrl?o==="url":(s=t.thumbnail)!=null&&s.isDataURI?o==="screenshot":null;if(i)return this._renderBookmarkImage(t,i)}_renderEditingThumbnail(t){const{_userState:e,visibleElements:o}=this,i=e==null?void 0:e.thumbnailState;return o.thumbnail&&i!=="none"?r("div",{class:k.authoringImageContainer},this._renderEditingBookmarkImage(t)):null}_renderUpdateThumbnailButton(){const{visibleElements:t,messages:e,_userState:o}=this,i=o==null?void 0:o.thumbnailState;return t.thumbnail&&i==="screenshot"?r("calcite-button",{appearance:"outline",class:k.authoringRefreshThumbnailButton,iconStart:"refresh",key:"update-thumbnail",kind:"neutral",onclick:()=>{this._updateThumbnail()},width:"half"},e.updateThumbnail):null}_renderEditingBookmarkUrlInput(t){var u,p;const{messages:e,_userState:o}=this,i=(u=t.thumbnail)==null?void 0:u.url,a=(p=t.thumbnail)!=null&&p.isSecureUrl?i:void 0,s=i&&(o==null?void 0:o.validationState)==="absolute-url-required";return(o==null?void 0:o.thumbnailState)==="url"?r("calcite-label",{key:"thumbnail-url-input"},r("calcite-input",{afterCreate:this._storeUrlEditInput,bind:this,name:"bookmark-thumbnail-url",pattern:rt,placeholder:e?`https://<${e.imageUrlPlaceholder}>`:void 0,required:!0,title:e.imageUrlTooltip,type:"text",value:a,onCalciteInputChange:this._handleUrlEditInputChange,onCalciteInputInput:this._handleUrlEditInputChange}),s?r("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},e.invalidImageUrl):null):null}_renderThumbnailSelector(){const{visibleElements:t,messages:e,_userState:o}=this,i=o==null?void 0:o.thumbnailState;return t.thumbnail?r("calcite-label",{key:"thumbnail-chip-group"},e.thumbnail,r("calcite-chip-group",{label:e.thumbnail,selectionMode:"single-persist",onCalciteChipGroupSelect:a=>this._handleThumbnailTypeSelect(a.target.selectedItems[0].value)},r("calcite-chip",{selected:i==="screenshot",value:"screenshot"},e.screenshot),r("calcite-chip",{selected:i==="url",value:"url"},e.url),r("calcite-chip",{selected:i==="none",value:"none"},e.none))):null}_renderEditingBookmark(t){const{disabled:e,messagesCommon:o,headingLevel:i}=this;return t?r("form",{bind:this,class:k.form,disabled:this.disabled,onsubmit:this._editBookmarkSubmit},r("calcite-flow-item",{afterCreate:this._focusEditFlowItemNode,afterUpdate:this._focusEditFlowItemNode,bind:this,disabled:e,heading:o.edit,headingLevel:i,key:"edit-bookmark-form",onCalciteFlowItemBack:a=>{a.preventDefault(),this._closeEditBookmarkForm()}},r("div",{class:k.formContent},r("div",{class:k.authoring},this._renderEditingBookmarkName(t),this._renderThumbnailSelector(),this._renderEditingThumbnail(t),this._renderEditingBookmarkUrlInput(t),this._renderUpdateThumbnailButton(),this._renderEditingTimeExtent(t))),this._renderEditingBookmarkActions())):null}_renderAddingBookmarkName(){const{_userState:t,messages:e}=this,o=(t==null?void 0:t.validationState)==="name-required";return r("calcite-label",null,e.title,r("calcite-input",{afterCreate:this._storeAddInput,bind:this,class:k.addBookmarkInput,name:"bookmark-name",placeholder:e.titlePlaceholder,required:!0,type:"text",value:""}),o?r("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},e.invalidTitle):null)}_renderAddingBookmarkActions(){const{messagesCommon:t}=this;return[r("calcite-button",{appearance:"outline",bind:this,onclick:this._endAddBookmark,slot:"footer",type:"button",width:"half"},t.cancel),r("calcite-button",{slot:"footer",type:"submit",width:"half"},t.add)]}_renderAddingBookmark(){const{disabled:t,messages:e,headingLevel:o,_userState:i}=this;return(i==null?void 0:i.state)==="add"?r("form",{bind:this,class:k.form,disabled:t,onsubmit:this._addBookmarkSubmitClick},r("calcite-flow-item",{afterCreate:this._focusAddFlowItemNode,afterUpdate:this._focusAddFlowItemNode,bind:this,disabled:t,heading:e.addBookmark,headingLevel:o,key:"add-bookmark-form",onCalciteFlowItemBack:a=>{a.preventDefault(),this._endAddBookmark()}},r("div",{class:k.formContent},this._renderAddingBookmarkName()),this._renderAddingBookmarkActions())):null}_getBookmarkTitle(t){return(t==null?void 0:t.name)||this.messagesCommon.untitled}_formatDate(t){var e;return t?M(t,{...P("short-date"),timeZone:((e=this.viewModel.view)==null?void 0:e.timeZone)??V}):""}_formatTime(t){var e;return t?M(t,{...P("long-time"),timeZone:((e=this.viewModel.view)==null?void 0:e.timeZone)??V}):""}_endAddBookmark(){this.endAddBookmark(),this._focusRootFlowItem=!0}_showEditBookmarkForm(t){t&&(this._editIncludeTimeExtent=!!t.timeExtent,this._userState=new U({bookmark:t,state:"edit"}),this._focusEditFlowItem=!0,this.viewModel.goTo(t))}async _createNewScreenshotUrl(){var e;return((e=(await this.viewModel.createBookmark()).thumbnail)==null?void 0:e.url)??null}_storeCurrentUrl(){var o,i,a,s,d,u;const{_userState:t}=this,e=(i=(o=t==null?void 0:t.editedBookmark)==null?void 0:o.thumbnail)==null?void 0:i.url;e&&((s=(a=t==null?void 0:t.editedBookmark)==null?void 0:a.thumbnail)!=null&&s.isSecureUrl?t.customUrl=e:(u=(d=t==null?void 0:t.editedBookmark)==null?void 0:d.thumbnail)!=null&&u.isDataURI&&(t.screenshotUrl=e))}async _handleThumbnailTypeSelect(t){const{_userState:e}=this;if(!e)return;const{screenshotUrl:o,customUrl:i,editedBookmark:a}=e,s=t==="screenshot"?o??await this._createNewScreenshotUrl():t==="url"&&i?i:null;this._storeCurrentUrl(),a&&s&&(a.thumbnail=new C({url:s})),e.validationState=void 0,e.thumbnailState=t}_closeEditBookmarkForm(){this._userState=null,this._focusRootFlowItem=!0}_addBookmarkSubmitClick(t){t.preventDefault(),this._addBookmarkSubmit()}async _addBookmarkSubmit(){const{_addInputNode:t,_userState:e,viewModel:o,viewModel:{bookmarks:i}}=this;if(!e)return;const a=t?t.value.trim():null;if(!a)return void(e.validationState="name-required");e.loading=!0;const s=await o.createBookmark();s.name=a,i.add(s),this._endAddBookmark()}async _editBookmarkAndClose(t,e){const{viewModel:o,viewModel:{defaultEditOptions:i}}=this;await o.editBookmark(t,{...i,...e}),this._closeEditBookmarkForm()}_editBookmarkSubmit(t){t.preventDefault();const{_editInputNode:e,_userState:o,_editIncludeTimeExtent:i,_urlEditInputNode:a}=this;if(!(o!=null&&o.bookmark)||!o.editedBookmark)return;o.validationState=void 0,o.customUrl=void 0,o.screenshotUrl=void 0;const s=e==null?void 0:e.value.trim();if(!s)return void(o.validationState="name-required");o.bookmark.name=s,o.bookmark.thumbnail=o.editedBookmark.thumbnail,i||(o.bookmark.timeExtent=null);const d=o.thumbnailState;if(d==="url"&&a){const u=a.value,p=new C({url:u});if(!p.isSecureUrl)return void(o.validationState="absolute-url-required");o.bookmark.thumbnail=p}else d==="none"&&(o.bookmark.thumbnail=null);this._editBookmarkAndClose(o.bookmark,{takeScreenshot:!1,captureTimeExtent:i})}_storeEditInput(t){this._editInputNode=t}_storeAddInput(t){this._addInputNode=t}_storeUrlEditInput(t){this._urlEditInputNode=t}_deleteBookmark(t){this._closeEditBookmarkForm(),t&&(this.viewModel.bookmarks.remove(t),t.destroy())}_goToBookmark(t){t&&(this.endAddBookmark(),this.viewModel.goTo(t))}async _updateThumbnail(){const{_userState:t,viewModel:e}=this;t&&(t.validationState=void 0,await e.editBookmark(t.editedBookmark,{takeScreenshot:!0,captureViewpoint:!1,captureRotation:!1,captureScale:!1,captureTimeExtent:!1}))}_focusRootFlowItemNode(t){this._focusRootFlowItem&&(this._focusRootFlowItem=!1,requestAnimationFrame(()=>t==null?void 0:t.setFocus()))}_focusEditFlowItemNode(t){this._focusEditFlowItem&&(this._focusEditFlowItem=!1,requestAnimationFrame(()=>t==null?void 0:t.setFocus()))}_focusAddFlowItemNode(t){this._focusAddFlowItem&&(this._focusAddFlowItem=!1,requestAnimationFrame(()=>t==null?void 0:t.setFocus()))}};n([l()],m.prototype,"_editIncludeTimeExtent",void 0),n([l({type:U})],m.prototype,"_userState",void 0),n([l()],m.prototype,"_focusRootFlowItem",void 0),n([l()],m.prototype,"_focusAddFlowItem",void 0),n([l()],m.prototype,"_focusEditFlowItem",void 0),n([l()],m.prototype,"defaultCreateOptions",null),n([l()],m.prototype,"defaultEditOptions",null),n([l()],m.prototype,"bookmarks",null),n([l()],m.prototype,"disabled",void 0),n([l()],m.prototype,"dragEnabled",void 0),n([l()],m.prototype,"editingEnabled",null),n([l()],m.prototype,"filterPlaceholder",void 0),n([l()],m.prototype,"filterText",void 0),n([l()],m.prototype,"headingLevel",void 0),n([l()],m.prototype,"goToOverride",null),n([l()],m.prototype,"icon",null),n([l()],m.prototype,"label",null),n([l(),q("esri/widgets/Bookmarks/t9n/Bookmarks")],m.prototype,"messages",void 0),n([l(),q("esri/t9n/common")],m.prototype,"messagesCommon",void 0),n([l()],m.prototype,"uiStrings",void 0),n([l()],m.prototype,"view",null),n([l({type:j}),lt(["select-bookmark","bookmark-edit","bookmark-select"])],m.prototype,"viewModel",void 0),n([l({type:F,nonNullable:!0})],m.prototype,"visibleElements",void 0),n([l()],m.prototype,"endAddBookmark",null),n([l()],m.prototype,"startAddBookmark",null),m=n([D("esri.widgets.Bookmarks")],m);const pt=m;export{pt as default};
