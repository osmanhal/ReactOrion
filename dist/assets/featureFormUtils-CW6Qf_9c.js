import{cp as f,aZ as $,c1 as V,cq as _,cr as v,bZ as b,cs as L,J as Z,ct as x,cu as j,bK as T,cv as A,cw as I,cx as R}from"./index-BfC8i6jT.js";import{Z as U}from"./utils-DcLVAL7v.js";const w=e=>(e==null?void 0:e.type)==="field",F=e=>(e==null?void 0:e.type)==="group",D=e=>(e==null?void 0:e.type)==="relationship",W=e=>e.type==="text",k=e=>!F(e)&&e.group!=null,N=e=>e.reduce((t,n)=>F(n)?[...t,...n.inputs]:[...t,n],[]),B=e=>N(e).filter(w),J=e=>N(e).filter(D),K=e=>e!=null&&(m(e,"combo-box")||m(e,"radio-buttons")),m=(e,t)=>{var n;return e!=null&&((n=e.input)==null?void 0:n.type)===t},Y=e=>e!=null&&(m(e,"text-box")||m(e,"text-area")),z=({domain:e,inputType:t="text-box",dataType:n})=>n==="number"&&t==="text-box"&&(!e||e.type!=="coded-value"),Q=e=>"items"in e;function X(e){const{attributes:t,fieldsIndex:n,label:r,timeZone:i}=e;if(!t||typeof t!="object")return r;const o=Object.keys(t).filter(s=>f(r,s)),u=o.map(s=>t[s]),a=o.map(s=>n.get(s)).filter($);return q(r,G({values:u,fields:a,timeZone:i}))}const c="expression/",S="expr/",C="field/";function ee(e){const[t,n]=e.split(c);return t===""&&n?n:(Z.getLogger("esri.widgets.FeatureForm/featureFormUtils").error("extractExpressionNameFromString:invalid-input",`The string ${e} is not a valid expression reference of the form '${c}/expressionName'`),"")}function te(e){return`${c}${e}`}function ne(e){return`${C}${e}`}function re(e){return e.startsWith(c)}function ie(e){return e.startsWith(S)}function G(e){const{fields:t,values:n}=e,r=e.timeZone??void 0,i=t.map((o,u)=>{let a=n[u];if(o.domain&&o.domain.type==="coded-value"){const s=o.domain.codedValues.find(p=>p.code===a);s!=null&&s.name&&(a=s.name)}return(U(o)||V(o))&&(a=_(o,a,{timeZone:r,...v(o)})),[o.name,a]});return Object.fromEntries(i)}function q(e,t){return b(b(e,n=>`{${n.toLowerCase()}}`),Object.fromEntries(Object.entries(t).map(([n,r])=>[n.toLowerCase(),r])))}const oe=e=>{var n,r,i,o;const t={typeFieldName:null,types:[]};return e&&(e.type==="subtype-sublayer"?(t.typeFieldName=(n=e.parent)==null?void 0:n.subtypeField,t.types=((r=e.parent)==null?void 0:r.subtypes)??[]):e.type==="subtype-group"||e.type==="feature"&&((i=e.subtypes)!=null&&i.length)?(t.typeFieldName=e.subtypeField,t.types=e.subtypes??[]):"types"in e&&e.types&&(t.typeFieldName=e.typeIdField,t.types=e.types.map(({id:u,name:a,domains:s})=>({code:u,name:a,domains:s}))),t.typeFieldName!=null&&(t.typeFieldName=((o=e.getField(t.typeFieldName))==null?void 0:o.name)??t.typeFieldName)),t},ae=(e,t)=>{if(!e)return!0;const{operations:n}=e;switch(t){case"INSERT":return n.supportsAdd;case"UPDATE":case"DELETE":return n.supportsUpdate;default:return!0}};var d;(function(e){e.TOO_SHORT="length-validation-error::too-short",e.TOO_LONG="length-validation-error::too-long"})(d||(d={}));const g={type:"number"},O={type:"number",intlOptions:{notation:"scientific"}};function h(e){return e>=1e7||e<=-1e7}function H(e,{validationErrors:t}){return e.max!=null&&e.min!=null?t.outsideRange:e.max!=null?t.outsideRangeMax:t.outsideRangeMin}const se=(e,t,n)=>{const{dataType:r,error:i,minLength:o,value:u,required:a}=e,s=t==null?void 0:t.validationErrors;if(!s||!i)return null;if(a&&u===null)return s.cannotBeNull;if(i===x.VALUE_OUT_OF_RANGE||i===j.OUT_OF_RANGE){const{field:p,range:l}=e,y={type:"date",intlOptions:{timeZone:p.type==="date"&&n?n:void 0,...v(p)}},E=H(l,t);return T(E,l,{format:{max:r==="date"?y:l.max!=null&&h(l.max)?O:g,min:r==="date"?y:l.min!=null&&h(l.min)?O:g}})}return i===x.INVALID_CODED_VALUE?s.invalidCodedValue:i===A.INVALID_TYPE?s.invalidType:i===d.TOO_SHORT?T(s.tooShort,{min:o}):(d.TOO_LONG,null)},ue=e=>{var i;if(!e)return;const t=e.layer,n=t&&"geometryType"in t?t.geometryType:void 0,r=(i=e.geometry)==null?void 0:i.type;return r==="polyline"||n==="polyline"?"line":r==="mesh"||n==="mesh"||n==="multipatch"?"cube":r==="multipoint"||n==="multipoint"?"point":r||n||"table"},le=e=>{var n;const t=[];if(e.formTemplate){const{description:r,title:i}=e.formTemplate;(n=e.fields)==null||n.forEach(o=>{const u=i&&f(i,o.name),a=r&&f(r,o.name);(u||a)&&t.push(o.name)})}return t};function pe(e,t){var r;const n=t??("formTemplate"in e&&e.formTemplate);return n?(((r=n.elements)==null?void 0:r.filter(I))??[]).some(({fieldName:i})=>!e.fieldsIndex.get(i)):!1}function me(e,t){return e==null||t.onValue!==e&&t.offValue!==e}function ce(e,t){var n;switch(t.objectType){case"any":return!0;case"null":return e==null;case"code":return e===((n=t.codedValue)==null?void 0:n.code);case"range":return e!=null&&t.minValue!=null&&t.maxValue!=null&&+e>=t.minValue&&+e<=t.maxValue;default:return L(t.objectType),!1}}function de(e,t,n){var o,u;if(!e||!("subtypes"in e))return!1;const r=(o=e.subtypes)==null?void 0:o.find(a=>a.code===n);if(!r)return!1;const i=(u=e.subtypes)==null?void 0:u.find(a=>a.code===t);return!R(r.defaultValues,i==null?void 0:i.defaultValues)&&Object.values(r.defaultValues).some(a=>a!=null)}export{ne as $,ue as B,oe as C,re as D,z as E,Y as F,ae as G,ee as I,me as J,ce as K,d as M,J as N,N as O,de as Q,te as R,G as S,k as T,X as U,Q as V,le as Y,F as b,D as g,K as h,B as j,se as q,m as v,ie as w,W as x,w as y,pe as z};
