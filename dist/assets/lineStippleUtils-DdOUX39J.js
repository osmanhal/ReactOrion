import{lM as I,f$ as R,g3 as b,lN as A,jl as E,lO as O,aC as T,eK as w}from"./index-BfC8i6jT.js";import{t as m,a as y}from"./DoubleArray-CZhUFo5d.js";import{I as F,t as S}from"./Texture-1xthaLvE.js";import{A as C}from"./Indices-Bl02GO-3.js";import{t as d}from"./orientedBoundingBox-Do1Vt1ct.js";import{e as v}from"./Material-CL7oq3ds.js";import{e as f}from"./VertexAttribute-BnAa5VW0.js";import{p as g,a as $}from"./triangulationUtils-en0lWBIB.js";import{q as N,t as L}from"./RenderGeometry-BYg-7xwk.js";function et(t,n,o=null){const a=[],r=n.mapPositions;U(n,a);const l=a[0][1].data,s=a[0][1].indices.length,e=C(s);return j(n,a,e),H(n,a,e),x(n,a,e),z(n,a,e),P(n,a,e),_(n,a,e),B(n,a,l),new F(t,a,r,v.Line,o)}function U(t,n){const{attributeData:{position:o},removeDuplicateStartEnd:a}=t,r=G(o)&&a,l=o.length/3-(r?1:0),s=new Array(2*(l-1)),e=r?o.slice(0,-3):o;let u=0;for(let c=0;c<l-1;c++)s[u++]=c,s[u++]=c+1;n.push([f.POSITION,new d(e,s,3,r)])}function j(t,n,o){if(t.attributeData.colorFeature!=null)return;const a=t.attributeData.color;n.push([f.COLOR,new d(a??I,o,4)])}function x(t,n,o){t.attributeData.normal&&n.push([f.NORMAL,new d(t.attributeData.normal,o,3)])}function z(t,n,o){t.attributeData.colorFeature!=null&&n.push([f.COLORFEATUREATTRIBUTE,new d([t.attributeData.colorFeature],o,1,!0)])}function H(t,n,o){t.attributeData.sizeFeature==null&&n.push([f.SIZE,new d([t.attributeData.size??1],o,1,!0)])}function P(t,n,o){t.attributeData.sizeFeature!=null&&n.push([f.SIZEFEATUREATTRIBUTE,new d([t.attributeData.sizeFeature],o,1,!0)])}function _(t,n,o){t.attributeData.opacityFeature!=null&&n.push([f.OPACITYFEATUREATTRIBUTE,new d([t.attributeData.opacityFeature],o,1,!0)])}function B(t,n,o){if(t.overlayInfo==null||t.overlayInfo.renderCoordsHelper.viewingMode!==R.Global||!t.overlayInfo.spatialReference.isGeographic)return;const a=m(o.length),r=b(t.overlayInfo.spatialReference);for(let p=0;p<a.length;p+=3)A(o,p,a,p,r);const l=o.length/3,s=S(l+1);let e=M,u=Z,c=0,h=0;E(e,a[h++],a[h++]),h++,s[0]=0;for(let p=1;p<l+1;++p)p===l&&(h=0),E(u,a[h++],a[h++]),h++,c+=O(e,u),s[p]=c,[e,u]=[u,e];n.push([f.DISTANCETOSTART,new d(s,n[0][1].indices,1,!0)])}function G(t){const n=t.length;return t[0]===t[n-3]&&t[1]===t[n-2]&&t[2]===t[n-1]}const M=T(),Z=T();function st(t,n){if(t==null||t.length===0)return[];const o=[];return t.forEach(a=>{const r=a.length,l=m(3*r);a.forEach((e,u)=>{l[3*u]=e[0],l[3*u+1]=e[1],l[3*u+2]=e[2]});const s={attributeData:{position:l,normal:n},removeDuplicateStartEnd:!1};o.push(s)}),o}function rt(t,n,o,a){const r=t.type==="polygon"?g.CCW_IS_HOLE:g.NONE,l=t.type==="polygon"?t.rings:t.paths,{position:s,outlines:e}=$(l,!!t.hasZ,r,t.spatialReference),u=m(s.length),c=N(s,t.spatialReference,0,u,0,s,0,s.length/3,n,o,a),h=c!=null;return{lines:h?D(e,s,u):[],projectionSuccess:h,sampledElevation:c}}function lt(t,n){const o=t.type==="polygon"?g.CCW_IS_HOLE:g.NONE,a=t.type==="polygon"?t.rings:t.paths,{position:r,outlines:l}=$(a,!1,o),s=w(r,t.spatialReference,0,r,n,0,r.length/3);for(let e=2;e<r.length;e+=3)r[e]=L;return{lines:s?D(l,r):[],projectionSuccess:s}}function D(t,n,o=null){const a=new Array;for(const{index:r,count:l}of t){if(l<=1)continue;const s=3*r,e=3*l;a.push({position:y(n,3*r,3*l),mapPositions:o!=null?y(o,s,e):void 0})}return a}const i={dash:[4,3],dot:[1,3],"long-dash":[8,3],"short-dash":[4,1],"short-dot":[1,1]},W={dash:i.dash,"dash-dot":[...i.dash,...i.dot],dot:i.dot,"long-dash":i["long-dash"],"long-dash-dot":[...i["long-dash"],...i.dot],"long-dash-dot-dot":[...i["long-dash"],...i.dot,...i.dot],none:null,"short-dash":i["short-dash"],"short-dash-dot":[...i["short-dash"],...i["short-dot"]],"short-dash-dot-dot":[...i["short-dash"],...i["short-dot"],...i["short-dot"]],"short-dot":i["short-dot"],solid:null},q=8;function K(t,n){return t==null?t:{pattern:t.slice(),pixelRatio:n}}function it(t){return{pattern:[t,t],pixelRatio:2}}function ut(t){return t!=null&&t.type==="style"?Y(t.style):null}function Y(t){return t!=null?K(W[t],q):null}export{st as R,et as b,it as h,lt as l,ut as n,rt as p};
